# ゲンシュンドラフトオンラインツールの使い方

## 目次
- [ゲンシュンドラフトとは](#header-5towk0oad3)
- [起動方法(事前準備)](#header-7a716g74re)
- [起動方法(サーバ起動)](#header-qijryeiwqs)
- [操作方法と注意事項](#header-fi6n6h6k0k)
- [カードプールの変更の仕方](#header-p4yg1o6o8j)

<a name="header-5towk0oad3"></a>
## ゲンシュンドラフトとは
ゲンシュンドラフト(通称芋ドラ)は、先行ドロー有りのマスタールール3、全カードにエラッタ適応、6人ないし8人用の遊戯王ドラフトである。

ペンデュラム前に遊戯王を引退したお爺ちゃん達と遊ぶことを想定しており、リンクや新規カードは入れていない(本来はペンデュラムもプールに入れたくなかったが)。

カードプールは、過去デッキやストラクの残骸、個人的なお気に入りカードが殆どなので、正直ドラフトプールの質は問いていないし、質を上げることも考えていない。

1人あたり3パックを配布。

6人ドラフトでは以下の構成で1パック22枚となる。

|カード種別|種類|枚数|合計|1パック内の枚数|
|:---|:--|:--|:--|--:|
|レア枠|12|3|36|2|
|モンスター枠|60|3|180|10|
|魔法枠|18|3|54|3|
|罠枠|18|3|54|3|
|エクストラ枠|36|2|72|4|

また、8人ドラフトでは以下の構成で1パック21枚となる。

|カード種別|種類|枚数|合計|1パック内の枚数|
|:---|:--|:--|:--|--:|
|レア枠|12|4|48|2|
|モンスター枠|60|4|240|10|
|魔法枠|18|4|72|3|
|罠枠|18|4|72|3|
|エクストラ枠|36|2|72|3|

<a name="header-7a716g74re"></a>
## 起動方法(事前準備)
- 前提条件。
  - nodeのバージョンが9.0.0以上。
  - npmのバージョンが6.0.0以上。
  - node及びnpmのPATHが通っている事(npmとnodeコマンドが使えること)。
  - Hamachiインストール済み。
- リポジトリを `git clone git@github.com:genshun9/graceful_charity.git`かdownloadZipする。
- `.env`というファイルを開き、`PUBLIC_IP=`の右側にある`localhost`をhamachiのIP(例:aa.bb.cc.dd)に書き換える。
<a name="header-qijryeiwqs"></a>
## 起動方法(サーバ起動)
- ターミナル上で `sh start.sh` を実行。
  - *注意*: shコマンドはwindowsPCでは実行できないが、`busybox`を使うことでwindowsでも起動できたことは確認できている。
  - 取り急ぎ、windows用のサーバ起動コマンド作ってるなうです。
- `サーバを起動: http://aa.bb.cc.dd:8000` という文字が表示されたら完了。
- 初期値ゲンシュンドラフトのカードプールで、6人ドラフト開始出来る。

<a name="header-fi6n6h6k0k"></a>
## 操作方法と注意事項
- 操作方法。
  - ピックツールの使い方自体は[遊戯王ドラフト用のオンラインピックツール紹介](https://youtu.be/uec0pONBNls)にて説明。
- 注意事項。
  - windows及びmacのChromeでの動作確認はしておりますが、IEやSafariは確認していない。

<a name="header-p4yg1o6o8j"></a>
## カードプールの変更の仕方
ver_3_0版リリースにより、比較的誰でもプレイヤー数やカードプールの変更ができるようになった、はず。。

### 仕組みの説明
- デフォルトが6人ドラフト用の設定になっているので、6人ドラフトにおけるカードプールの変更の仕方を以下に記載。
- `.env`ファイルを開くと、以下のような設定項目がある。
```
RARE_CARD_INIT_NUMBER=2
MONSTER_CARD_INIT_NUMBER=10
MAGIC_CARD_INIT_NUMBER=3
TRAP_CARD_INIT_NUMBER=3
EXTRA_CARD_INIT_NUMBER=4
ROUTATION_MAX_NUMBER=22
```
- これは1パック内の、レア枠・モンスター枠・魔法枠・罠枠・エクストラ枠の、それぞれの枚数を表現する。
- つまり、レア2枚、モンスター10枚、魔法3枚、罠3枚、エクストラ4枚、合計22枚が `ROUTATION_MAX_NUMBER` と同じ数値になっている。
  - 各枠の合計が `ROUTATION_MAX_NUMBER` と同じになるようにする必要がある。
- カード画像は `assets/img` 配下に `.jpg` 形式で保存。
- カードプール情報は、`assets/inputCardList` 配下に`txt`形式で保存。
  - `rare.txt`意外は、カンマ区切りで左から順に「カード名」「カード画像の名前」「枚数」を表現している。
  - `rare.txt`は、上記に加えて「カード種別（モンスターか魔法かみたいな）」を表現、`モンスター:1、魔法:2、罠:3、エクストラ:4`としている。
- 例えばエクストラカードについては、`EXTRA_CARD_INIT_NUMBER`が4なので、つまり1パックにつき4枠×6人×3パックの合計72枚のカードがこのドラフトで必要である。
  - `assets/inputCardList/extra.txt`をみると、36行存在し、一番右が`2`になっているので、36種×2枚の合計72枚となっている。
  - `assets`配下に36種類のエクストラカードの画像が置いてある。

### カードプールの変更例
- カードを変更したい場合。
  - モンスター枠の「エフェクト・ヴェーラー」を「灰流うらら」に変更する例を以下に記載。
  - 「灰流うらら」の画像を`assets/img`配下に `XXXX.jpg`として保存する。
  - `assets/inputCardList/monster.txt`に、「エフェクト・ヴェーラー」の行が、カンマ区切りになっているので以下のように変更する。
    - 左の名前を「灰流うらら」に変更、1つ目のカンマ区切りの右側の文字列は「エフェクト・ヴェーラー」の画像名を指しているので、これを`XXXX`に変更する。
    - **カンマ区切りのtxtファイルは、空白文字は禁止である**
  - ターミナル上で`sh start.sh`を実行する。
- 各パックの枠数を変更したい場合。
  - 例えばモンスター枠を10から8に変更する例を以下に記載。
  - `.env`ファイルの`MONSTER_CARD_INIT_NUMBER`を10から8へ、合計枚数が22から20になったので`ROUTATION_MAX_NUMBER`を22から20に変更する。
  - `assets/inputCardList/monster.txt`は現在60行あり、カンマ区切りの一番右が全て3となっているので、モンスターの種類は60枚で、それぞれ3枚ずつの180枚存在している。
  - これを8枠×6人×3パックの144枚になるためには、48行(48*3=144)にする。
  - ターミナル上で`sh start.sh`を実行する。
